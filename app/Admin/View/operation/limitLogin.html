{{include file="../common/1header.html"}}
<link href="{{CSS}}jin/3.09.notice.css" rel="stylesheet">
<!--|↓↓↓↓↓↓|-->
<div class="jin-content-title"><span>限制登录设置</span></div>
<hr/>
<div class="col-sm-5" >
    <div class="form-group">
        <label for="black" class="control-label">IP</label>
        <input type="text" id="black" >
        <button id="updateIP" class="btn  btn-success in-search-input">添加</button>
    </div>
    <div class="form-group">
        <label for="devicecode" class="control-label">设备号</label>
        <input type="text" id="devicecode"  >
        &nbsp;
        原因：
        <select id="reason">
        <option>禁止登录，如有疑问请联系客服！</option>
        </select>
        <button id="updateCode" class="btn  btn-success in-search-input">添加</button>
    </div>
    <div class="form-group">
        <label for="acc" class="control-label">账号</label>
        <input type="text" id="acc" >
        <button id="updateAcc" class="btn  btn-success in-search-input">添加</button>
    </div>
</div>
<hr/>


<div class="col-sm-8 col-sm-offset-2">
    <div class="table-responsive">
        <table class="table table-bordered text-center">
            <thead>
            <tr>
                <th class="jin-role-column1">编号</th>
                <th>内容</th>
                <th>原因</th>
                <th>操作</th>
            </tr>
            </thead>
            <tbody id="content"></tbody>
        </table>
    </div>
    <div id="page"></div>
</div>

<!--|↑↑↑↑↑↑|-->
{{include file="../common/2footer.html"}}
<script>
    selectReason();
    $("#updateIP").on('click',function () {
        var data={};
        data.content = $("#black").val();
        data.reason = "禁止登录";
        insertReason(data);
    });
    $("#updateAcc").on('click',function () {
        var data={};
        data.content = $("#acc").val();
        data.reason = "账号禁止登录";
        insertReason(data);
    });
    $("#updateCode").on('click',function () {
        var data={};
        data.content = $("#devicecode").val();
        data.reason = $("#reason").val();
        insertReason(data);
    });
    function insertReason(data) {
        $.ajax({
            type: "post",
            url: location.href + "&jinIf=911",
            data: data,
            dataType: "json",
            success: function (json) {

                layer.alert('修改成功', {icon: 1}, function (index) {
                    layer.close(index);
                    selectReason();
                    $("#black").val('');
                    $("#devicecode").val('');
                    $("#acc").val('');
                });
            }
        });
    }
    function selectReason() {
        var data = {};
        var url = location.href + '&jinIf=912';
        var btn = [
            '<div class="btn-group btn-group-sm">' +
            '<a data-type="delete" class="btn btn-danger">删除</a>' +
            '</div>'
        ];
        var arr = ['id', 'content', 'reason',btn];
        var id = "#content";
        noPageContentList(url, data, id, arr);
    }
    $('#content').on('click', 'a[data-type="delete"]', function () {
        var id = $(this).parents('tr').find('td').eq(0).text();
        layer.alert('确认删除？', {icon: 0, btn: ['确定', '取消'], shadeClose: true}, function () {
            $.ajax({
                type: "POST",
                url: location.href + "&jinIf=914",
                data: {
                    id: id
                },
                dataType: "json",
                success: function (json) {
                    layer.alert('删除成功', {icon: 1}, function (index) {
                        layer.close(index);
                        selectReason();
                    });
                }
            });
        });
    })


</script>