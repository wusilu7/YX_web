{{include file="../common/1header.html"}}
<link href="{{CSS}}jin/3.09.notice.css" rel="stylesheet">
<!--|↓↓↓↓↓↓|-->
<div class="jin-content-title"><span>特殊角色</span></div>
<div class="alert alert-info">
    <div id="group_server"></div>
</div>
<div style="float: left;">
    <label for="char" class="control-label">角色ID</label>
    <input type="text" id="char" >
    <button id="updateAcc" class="btn  btn-success in-search-input">添加</button>
</div>
<hr/>
<div class="col-sm-8 col-sm-offset-2">
    <div class="table-responsive">
        <table class="table table-bordered text-center">
            <thead>
            <tr>
                <th class="jin-role-column1">编号</th>
                <th>角色id</th>
                <th>时间</th>
                <th>操作者</th>
                <th>操作</th>
            </tr>
            </thead>
            <tbody id="content"></tbody>
        </table>
    </div>
    <div id="page"></div>
</div>

<!--|↑↑↑↑↑↑|-->
{{include file="../common/2footer.html"}}
<script>
    $(document).ready(gsSelect('#group', '#server','#platform',selectReason));
    $("#updateAcc").on('click',function () {
        var data={};
        data.content = $("#char").val();
        data.si = $("#server").val();
        insertReason(data);
    });
    function insertReason(data) {
        $.ajax({
            type: "post",
            url: location.href + "&jinIf=911",
            data: data,
            dataType: "json",
            success: function (json) {
                if(json!=2){
                    layer.alert('成功', {icon: 1}, function (index) {
                        layer.close(index);
                        selectReason();
                        $("#char").val('');
                    });
                }else{
                    layer.alert('角色不存在', {icon: 2}, function (index) {
                        layer.close(index);
                    });
                }
            }
        });
    }
    var data ={};
    function selectReason() {
        data.page = 1;
        data.si = $("#server").val();
        var url = location.href + '&jinIf=912';
        var btn = function (json) {
            return '<div class="btn-group btn-group-sm">' +
            '<a data-type="delete" data-data-name="'+json.createuser+'" class="btn btn-danger">删除</a>' +
            '</div>'
        };
        var arr = ['id', 'char_id','createtime','createuser',btn];
        var id = ["#content", "#page"];
        tableList(url, data, id, arr);
    }
    $('#content').on('click', 'a[data-type="delete"]', function () {
        var id = $(this).parents('tr').find('td').eq(0).text();
        var info = $(this).parents('tr').find('td').eq(1).text();
        var create_user = $(this).attr('data-data-name');
        layer.alert('确认删除？', {icon: 0, btn: ['确定', '取消'], shadeClose: true}, function () {
            $.ajax({
                type: "POST",
                url: location.href + "&jinIf=914",
                data: {
                    id: id,
                    info:info,
                    create_user:create_user
                },
                dataType: "json",
                success: function (json) {
                    layer.alert('删除成功', {icon: 1}, function (index) {
                        layer.close(index);
                        selectReason();
                    });
                }
            });
        });
    })


</script>